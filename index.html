
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tool Suite</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Roboto, sans-serif;
      background-color: #121212;
      color: #e0e0e0;
    }
    .tabs {
      display: flex;
      background-color: #1e1e1e;
      justify-content: center;
      padding: 1rem 0;
    }
    .tab {
      padding: 0.7rem 1.5rem;
      cursor: pointer;
      background-color: #2a2a2a;
      border: none;
      color: white;
      margin: 0 0.5rem;
      border-radius: 6px;
      transition: background-color 0.3s;
    }
    .tab:hover {
      background-color: #333;
    }
    .tab.active {
      background-color: #6200ee;
    }
    .tab-content {
      display: none;
      padding: 2rem;
    }
    .tab-content.active {
      display: block;
    }
    .container {
      background-color: #1e1e1e;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      width: 90%;
      max-width: 700px;
      margin: 2rem auto;
      text-align: center;
    }
    textarea {
      width: 90%;
      height: 140px;
      background-color: #2a2a2a;
      color: #e0e0e0;
      border: none;
      outline: none;
      resize: none;
      padding: 1rem;
      font-size: 0.95rem;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    button {
      background-color: #6200ee;
      color: white;
      border: none;
      padding: 0.7rem 1.5rem;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      margin: 0.5rem;
    }
    button:hover {
      background-color: #7c28ff;
    }
    button:active {
      transform: scale(0.97);
    }
    #status {
      margin-top: 1rem;
      font-size: 0.9rem;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    #status.show {
      opacity: 1;
      color: #4caf50;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 20px;
      color: #e0e0e0;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    input[type="number"] {
      width: 80px;
      background-color: #2a2a2a;
      color: #e0e0e0;
      border: none;
      padding: 5px;
      border-radius: 4px;
    }
    #ltl-result {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="tabs">
    <button class="tab active" onclick="showTab('extractor')">Email Extractor</button>
    <button class="tab" onclick="showTab('ltl')">LTL Calculator</button>
  </div>

  <div id="extractor" class="tab-content active">
    <div class="container">
      <h1>Email Extractor</h1>
      <p>Paste Salesforce email addresses below:</p>
      <textarea id="input" placeholder='Paste emails here'></textarea><br>
      <button onclick="extractEmails()">Extract & Copy</button>
      <div id="status">Copied to clipboard!</div>
    </div>
  </div>

  <div id="ltl" class="tab-content">
    <div class="container">
      <h1>LTL Linear Feet Calculator</h1>
      <table id="palletTable">
        <thead>
          <tr>
            <th>Length (in)</th>
            <th>Width (in)</th>
            <th>Skids/Pieces</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <button onclick="addRow()">Add Pallet</button>
      <button onclick="calculateLinearFeet()">Calculate Linear Feet</button>
      <div id="ltl-result"></div>
    </div>
  </div>

  <script>
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      document.querySelectorAll('.tab').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
    }

    function extractEmails() {
      const input = document.getElementById('input').value;
      const blacklist = ['routing@wwex.com'];
      const emails = input.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-z]{2,}/gi);
      if (!emails || emails.length === 0) {
        showStatus('No emails found!', false);
        return;
      }
      const filtered = [...new Set(emails.filter(e => !blacklist.includes(e.toLowerCase())))];
      filtered.sort((a, b) => {
        const aIsWeex = a.toLowerCase().endsWith('@weex');
        const bIsWeex = b.toLowerCase().endsWith('@weex');
        return (aIsWeex === bIsWeex) ? a.localeCompare(b) : aIsWeex ? -1 : 1;
      });
      const cleaned = filtered.join(', ');
      document.getElementById('input').value = cleaned;
      navigator.clipboard.writeText(cleaned).then(() => {
        showStatus('Copied to clipboard!', true);
      });
    }

    function showStatus(message, success) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.style.color = success ? '#4caf50' : '#ff5252';
      status.classList.add('show');
      setTimeout(() => status.classList.remove('show'), 2000);
    }

    function addRow() {
      const table = document.getElementById('palletTable').getElementsByTagName('tbody')[0];
      const row = table.insertRow();
      row.innerHTML = `
        <td><input type="number" min="1" required></td>
        <td><input type="number" min="1" required></td>
        <td><input type="number" min="1" value="1" required></td>
        <td><button onclick="this.parentElement.parentElement.remove()">Remove</button></td>
      `;
    }

    function calculateLinearFeet() {
      const rows = document.querySelectorAll('#palletTable tbody tr');
      let pallets = [];
      let totalQuantity = 0;

      rows.forEach(row => {
        const inputs = row.querySelectorAll('input');
        const length = parseFloat(inputs[0].value);
        const width = parseFloat(inputs[1].value);
        const quantity = parseInt(inputs[2].value);
        totalQuantity += quantity;
        for (let i = 0; i < quantity; i++) {
          pallets.push({ length, width });
        }
      });

      if (totalQuantity <= 1) {
        document.getElementById('ltl-result').innerHTML = '<span style="color: #ff5252">Please enter more than one Skid/Piece.</span>';
        return;
      }

      pallets.sort((a, b) => b.width - a.width);
      const maxWidth = 96;
      let rowsUsed = [];

      while (pallets.length > 0) {
        let row = [];
        let remainingWidth = maxWidth;

        for (let i = pallets.length - 1; i >= 0; i--) {
          const pallet = pallets[i];
          if (pallet.width <= remainingWidth) {
            row.push(pallet);
            remainingWidth -= pallet.width;
            pallets.splice(i, 1);
          }
        }

        rowsUsed.push(row);
      }

      const totalInches = rowsUsed.reduce((sum, row) => {
        const maxLength = Math.max(...row.map(p => p.length));
        return sum + maxLength;
      }, 0);

      const linearFeet = totalInches / 12;
      const resultDiv = document.getElementById('ltl-result');
      let message = `Total Rows: ${rowsUsed.length}, Total Linear Feet: ${linearFeet.toFixed(2)}<br>`;
      if (linearFeet <= 12) {
        message += '<span style="color: #4caf50">Yes, this can go LTL</span>';
      } else {
        message += '<span style="color: #ff5252">This cannot go LTL</span>';
      }
      resultDiv.innerHTML = message;
    }

    addRow();
  </script>
</body>
</html>
